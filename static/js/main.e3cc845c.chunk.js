(this["webpackJsonpsound-painting"]=this["webpackJsonpsound-painting"]||[]).push([[0],{34:function(e,t,n){},35:function(e,t,n){},46:function(e,t,n){},47:function(e,t,n){},57:function(e,t,n){"use strict";n.r(t);var a=n(13),i=n(8),s=n.n(i),o=n(22),c=n.n(o),r=n(14),l=(n(34),n(69)),u=(n(35),n(7)),d=n.n(u),p=n(9),f=n(10),v=n(12),h=n(11),y=n(0),m=n(1),g=n(19),j=n(27),b=new(function(){function e(){var t=this;Object(y.a)(this,e),this.painting=null,this.loadedSounds=new Map,this.players=new Map,this.meters=new Map,this.soundSourceLevels=new Map,this.soundSourceRipples=new Map,this.overlayFade=1,this.isOverlayVisible=!0,this.animateSoundSources=function(){var e,n=Object(v.a)(t.meters.entries());try{for(n.s();!(e=n.n()).done;){var a=e.value,i=Object(f.a)(a,2),s=i[0],o=i[1],c=g.c(o.getValue());t.soundSourceRipples.set(s,c)}}catch(r){n.e(r)}finally{n.f()}requestAnimationFrame((function(){t.animateSoundSources()}))},Object(r.f)(this,{painting:r.g,loadedSounds:r.g,soundSourceLevels:r.g,soundSourceRipples:r.g,overlayFade:r.g,isOverlayVisible:r.g,isLoaded:r.c}),this.setMouseListeners(),requestAnimationFrame((function(){t.animateSoundSources()}))}return Object(m.a)(e,[{key:"isLoaded",get:function(){return Object(h.a)(this.loadedSounds.values()).every((function(e){return 1==e}))}}]),Object(m.a)(e,[{key:"setMouseListeners",value:function(){var e=this;window.addEventListener("mousemove",(function(t){var n=window.innerWidth,a=window.innerHeight;e.setSoundPosition(t.pageX/n,t.pageY/a)}),!1)}},{key:"setPainting",value:function(e){var t=this;this.painting=e;var n=e.key;e.sounds.forEach((function(e){var a=e.file;if(!t.players.get(a)){var i="".concat("/listen-paintings","/").concat(n,"/").concat(a),s=new g.b(i,(function(){console.log("loaded",a),t.loadedSounds.set(a,!0)})).toDestination(),o=new g.a(.8);s.connect(o),t.meters.set(a,o),t.players.set(a,s),s.loop=!0,s.volume.value=-12,t.loadedSounds.set(a,!1)}}))}},{key:"playSounds",value:function(){var e=Object(p.a)(d.a.mark((function e(){var t=this;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.e();case 2:this.painting.sounds.forEach((function(e){var n=t.players.get(e.file);n&&"started"!==n.state&&n.start()}));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"fadeOutOverlay",value:function(){var e=Object(p.a)(d.a.mark((function e(){var t=this;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.animatedOverlay){e.next=2;break}return e.abrupt("return");case 2:return this.animatedOverlay=new j.a({start:1,end:0}),e.next=5,this.animatedOverlay.play(500,(function(){t.overlayFade=t.animatedOverlay.value()}));case 5:this.isOverlayVisible=!1,this.animatedOverlay=null;case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setSoundPosition",value:function(e,t){var n=this;this.painting.sounds.forEach((function(a){var i=document.getElementById(a.file),s=Object(f.a)(a.position,2),o=s[0],c=s[1],r=a.radius;if(i){var l=Math.abs(o-e),u=Math.abs(c-t),d=Math.sqrt(Math.pow(l,2)+Math.pow(u,2)),p=1-Math.min(1,d/r),v=g.d(p),h=n.players.get(a.file);n.soundSourceLevels.set(a.file,p),h&&(h.volume.value=v+-12)}}))}}]),e}());n(46);var O=Object(l.a)((function(){var e={opacity:.75*b.overlayFade};return Object(a.jsx)("div",{className:"overlay",style:e,children:b.isLoaded?Object(a.jsx)("span",{className:"state loaded",onClick:function(){b.fadeOutOverlay(),b.playSounds()},children:"Start"}):Object(a.jsx)("div",{className:"state loading",children:"Loading..."})})})),x=n(25),w=n.n(x),S=(n(47),100),k=1.25;var L=function(e){var t=e.sound,n=Object(f.a)(t.position,2),s=n[0],o=n[1],c=Object(i.useRef)(null),l=Object(i.useRef)(null);Object(i.useEffect)((function(){var e=Object(r.b)((function(){var e=b.soundSourceLevels.get(t.file),n=b.soundSourceRipples.get(t.file);if(void 0!=e){var a=c.current,i=l.current,s=.5*e+.5;s*=1-b.overlayFade;var o=40*e+80;a.style.opacity=s,a.style.width="".concat(o,"px"),a.style.height="".concat(o,"px"),a.style.marginLeft="".concat(-o/2,"px"),a.style.marginTop="".concat(-o/2,"px");var r=o*k+1e3*n;i.style.opacity=s,i.style.width="".concat(r,"px"),i.style.height="".concat(r,"px"),i.style.marginLeft="".concat(-r/2,"px"),i.style.marginTop="".concat(-r/2,"px")}}));return function(){e()}}),[]);var u={width:"".concat(S,"px"),height:"".concat(S,"px"),marginLeft:"".concat(-50,"px"),marginTop:"".concat(-50,"px"),left:"".concat(100*s,"%"),top:"".concat(100*o,"%"),backgroundColor:t.color,opacity:0},d={width:"".concat(125,"px"),height:"".concat(125,"px"),marginLeft:"".concat(-62.5,"px"),marginTop:"".concat(-62.5,"px"),left:"".concat(100*s,"%"),top:"".concat(100*o,"%"),opacity:0};return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("div",{ref:l,className:"ripple",style:d}),Object(a.jsx)("div",{id:t.file,ref:c,className:"sound-icon",style:u,children:Object(a.jsx)(w.a,{style:{fontSize:48}})})]})};var M=Object(l.a)((function(){var e=b.painting,t="".concat("/listen-paintings","/").concat(e.key,"/image.jpg");return Object(a.jsx)("div",{className:"App",children:Object(a.jsxs)("div",{className:"image-container",children:[b.isOverlayVisible?Object(a.jsx)(O,{}):null,e.sounds.map((function(e){return Object(a.jsx)(L,{sound:e},e.file)})),Object(a.jsx)("img",{src:t,className:"painting",alt:""}),Object(a.jsxs)("div",{className:"image-description",children:[Object(a.jsx)("span",{className:"title",children:e.name}),Object(a.jsx)("span",{className:"artist",children:e.artist})]})]})})}));Object(r.d)({enforceActions:"never"});var N={name:"Impression, Sunrise",artist:"Claude Monet",key:"monet",width:1280,height:993,sounds:[{file:"foghorn.mp3",position:[.1,.15],radius:.3,color:"coral"},{file:"gulls.mp3",position:[.8,.2],radius:.5,color:"coral"},{file:"harborwaves.mp3",position:[.5,.8],radius:.7,color:"coral"}]};b.setPainting(N),c.a.render(Object(a.jsx)(s.a.StrictMode,{children:Object(a.jsx)(M,{})}),document.getElementById("root"))}},[[57,1,2]]]);
//# sourceMappingURL=main.e3cc845c.chunk.js.map